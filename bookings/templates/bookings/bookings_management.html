{% extends "base.html" %}

{% load crispy_forms_tags %}

{% block content %}

{% if user.is_superuser %}
  <div class="row">
    <div class="booking-page col-sx-12 col-md-6">
      <div class="text-center manage-bookings">
        <div>
          <h2>Manage Bookings</h2>
          <form class="form-inline float-right">
            <input class="form-control mr-sm-2" type="text" placeholder="Search by guest" name="search">
            <button class="btn my-2 my-sm-0" type="submit">Find Booking</button>
          </form>
        </div>

        <div class="btn-group mr-2" role="group">
          <a href="?filter=all" class="btn">All</a>
          <a href="?filter=day" class="btn">Today</a>
          <a href="?filter=week" class="btn">This week</a>
        </div>
        <hr>

        {% if grouped_results %}
          <div class="booking-list-scroller">
            <div class="container">
              {% for result in grouped_results %}
              <h3>{{ result.day|date:"F d" }}</h3>
              <div class="booking-book">
                {% for booking in result.bookings %}
                  <div class="card booking-card">
                      <a href="{% url 'edit_booking' booking_id=booking.id %}">
                        <div>{{ booking.user.username|slice:"-10:" }}</div>
                        <div>Table # {{ booking.table.number }}</div>
                        <div>{{ booking.size_of_party }} <i class="fa-solid fa-user-group"></i></div>
                        <div>{{ booking.start_time|time:"g:i A" }}</div>
                      </a>
                  </div>
                {% endfor %}
              </div>
              <hr>
              {% endfor %}
            </div>
          </div>
          {% else %}
          <p>No bookings found.</p>
          {% endif %}

      </div>
    </div> 
  </div>

  </div>
    <script>  
      // JavaScript code to update the value display element
      var slider = document.getElementById('id_size_of_party');
      var sliderValue = document.getElementById('slider_value');

      sliderValue.innerHTML = slider.value; // Initial value

      slider.oninput = function() {
      sliderValue.innerHTML = this.value;
      };
    </script>
{% else %}
    <script>
        window.location.href = "{% url 'home' %}";
    </script>
{% endif %}



{% endblock %}
